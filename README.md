# BUSI_Segmentation_SegFormer
Using the publicly available Breast Ultrasound Images (BUSI) dataset. It contains 780 images from 600 female patients, categorized into normal, benign, and malignant cases, each with a corresponding ground truth mask outlining the lesion area. All images were manually annotated by expert radiologists and underwent pre-processing. This dataset has been widely used within the scientific community in recent years. Nevertheless, previous authors have detected some anomalies in the annotations. After carefully exploring the dataset, we realized that many cases seem to be repeated and slightly misannotated. To further investigate the nature of BUSI and avoid bias in the model evaluation, a duplicate image recognition and mask evaluation were performed.

For this task, we utilized the SegFormer architecture, a transformer-based segmentation framework that combines a hierarchical ViT encoder with a lightweight multilayer perceptron decoder. The encoder adopts a multi-stage design where each stage extracts increasingly abstract features using overlapping patch embeddings and efficient self-attention. This structure allows the model to capture both fine spatial details and global contextual information, which is essential for breast ultrasound where lesions often exhibit blurred boundaries and variable echogenic patterns. The MLP-based decoder aggregates features from all encoder stages using simple yet effective fusion layers, producing high-resolution segmentation maps without the heavy computational cost associated with conventional transformer decoders.

The BUSI dataset was divided into 70 percent training, 15 percent validation, and 15 percent testing subsets with a balanced distribution across lesion types. The model was trained with the Adam optimizer using an initial learning rate of 1e-4, a polynomial decay scheduler, a batch size of 8, and 50 epochs, with early stopping based on the validation mean Intersection over Union (mIoU). To increase robustness to acquisition variability, spatial and color augmentations were applied, including horizontal and vertical flips, rotation, hue and brightness variation.

<img width="1108" height="1251" alt="תמונה1" src="https://github.com/user-attachments/assets/da8004c4-3fae-460c-825b-081c8d5979fe" />
